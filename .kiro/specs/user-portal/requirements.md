# éœ€æ±‚æ–‡æ¡£ - AAE ä¸»ç«™ï¼ˆUser Portalï¼‰

## ç®€ä»‹ï¼ˆIntroductionï¼‰

AAE ä¸»ç«™æ˜¯æ•´ä¸ª Automated Ad Engine ç³»ç»Ÿçš„**ç”¨æˆ·å…¥å£å’Œæ ¸å¿ƒæ•°æ®ç®¡ç†å¹³å°**ã€‚ç”¨æˆ·é€šè¿‡ä¸»ç«™è®¿é—®ç³»ç»Ÿï¼Œä¸»ç«™å†…åµŒ**ç»Ÿä¸€ AI Agent å¯¹è¯ç•Œé¢**ï¼Œç”¨æˆ·é€šè¿‡å¯¹è¯å®Œæˆæ‰€æœ‰æ“ä½œã€‚ä¸»ç«™è´Ÿè´£ç”¨æˆ·è®¤è¯ã€è´¦æˆ·ç®¡ç†ã€è®¢é˜…è®¡è´¹ã€å¹¿å‘Šè´¦æˆ·ç»‘å®šï¼Œä»¥åŠæ‰€æœ‰ä¸šåŠ¡æ•°æ®çš„å­˜å‚¨å’Œç®¡ç†ï¼ˆç´ æç®¡ç†ã€æŠ¥è¡¨ç®¡ç†ã€è½åœ°é¡µç®¡ç†ã€æŠ•æ”¾ç®¡ç†ç­‰ï¼‰ï¼Œå¹¶ä¸º AI Agent æä¾› MCP Server æ¥å£ã€‚

## æœ¯è¯­è¡¨ï¼ˆGlossaryï¼‰

- **AAE System**ï¼šAutomated Ad Engineï¼Œè‡ªåŠ¨åŒ–å¹¿å‘Šå¼•æ“ç³»ç»Ÿ
- **User Portal**ï¼šç”¨æˆ·é—¨æˆ·ï¼ŒAAE ç³»ç»Ÿçš„æ ¸å¿ƒæ•°æ®ç®¡ç†å¹³å°
- **Ad Account**ï¼šå¹¿å‘Šè´¦æˆ·ï¼Œç”¨æˆ·åœ¨ Meta/TikTok/Google çš„å¹¿å‘Šè´¦æˆ·
- **Subscription**ï¼šè®¢é˜…ï¼Œç”¨æˆ·çš„ä»˜è´¹å¥—é¤
- **OAuth Token**ï¼šOAuth ä»¤ç‰Œï¼Œç”¨äºè®¿é—®å¹¿å‘Šå¹³å° API çš„æˆæƒå‡­è¯
- **Dashboard**ï¼šä»ªè¡¨æ¿ï¼Œç”¨æˆ·ç™»å½•åçš„ä¸»é¡µé¢
- **Billing**ï¼šè®¡è´¹ç³»ç»Ÿï¼Œå¤„ç†è®¢é˜…å’Œæ”¯ä»˜
- **Creative Library**ï¼šç´ æåº“ï¼Œå­˜å‚¨æ‰€æœ‰ç”Ÿæˆçš„å¹¿å‘Šç´ æ
- **Campaign Management**ï¼šæŠ•æ”¾ç®¡ç†ï¼Œç®¡ç†æ‰€æœ‰å¹¿å‘ŠæŠ•æ”¾æ•°æ®
- **Landing Page Library**ï¼šè½åœ°é¡µåº“ï¼Œå­˜å‚¨æ‰€æœ‰ç”Ÿæˆçš„è½åœ°é¡µ
- **Report Data**ï¼šæŠ¥è¡¨æ•°æ®ï¼Œå­˜å‚¨ä»å¹¿å‘Šå¹³å°æŠ“å–çš„æ•°æ®
- **MCP**ï¼šModel Context Protocolï¼Œæ¨¡å‹ä¸Šä¸‹æ–‡åè®®
- **Orchestrator**ï¼šåè°ƒå™¨ï¼ŒUnified AI Agent ä¸­è´Ÿè´£åè°ƒèƒ½åŠ›æ¨¡å—çš„ç»„ä»¶

---

## ç³»ç»Ÿæ¶æ„ï¼ˆSystem Architectureï¼‰

User Portal ä½œä¸ºç”¨æˆ·å…¥å£å’Œæ ¸å¿ƒæ•°æ®ç®¡ç†å¹³å°ï¼ŒåŒ…å«ä»¥ä¸‹åŠŸèƒ½æ¨¡å—ï¼š

### å‰ç«¯æ¨¡å—

1. **ç”¨æˆ·ç•Œé¢**ï¼šNext.js 14 + TypeScript + Tailwind CSS
2. **ç»Ÿä¸€ AI Agent å¯¹è¯ç•Œé¢**ï¼šåµŒå…¥å¼èŠå¤©ç»„ä»¶ï¼ˆWebSocket å®æ—¶é€šä¿¡ï¼‰
3. **Dashboard ä»ªè¡¨æ¿**ï¼šæ•°æ®å¯è§†åŒ–ã€å¿«é€Ÿæ“ä½œ
4. **æ•°æ®ç®¡ç†ç•Œé¢**ï¼šç´ æåº“ã€æŠ¥è¡¨ã€è½åœ°é¡µã€æŠ•æ”¾ç®¡ç†

### åç«¯æ¨¡å—

1. **ç”¨æˆ·è®¤è¯æ¨¡å—**ï¼šæ³¨å†Œã€ç™»å½•ã€æƒé™ç®¡ç†
2. **è®¢é˜…è®¡è´¹æ¨¡å—**ï¼šè®¢é˜…ç®¡ç†ã€æ”¯ä»˜å¤„ç†ã€å‘ç¥¨ç”Ÿæˆ
3. **å¹¿å‘Šè´¦æˆ·ç®¡ç†æ¨¡å—**ï¼šOAuth ç»‘å®šã€Token ç®¡ç†
4. **ç´ æç®¡ç†æ¨¡å—**ï¼šå­˜å‚¨å’Œç®¡ç†æ‰€æœ‰å¹¿å‘Šç´ æï¼ˆå›¾ç‰‡/è§†é¢‘ï¼‰
5. **æŠ¥è¡¨æ•°æ®æ¨¡å—**ï¼šå­˜å‚¨ä»å¹¿å‘Šå¹³å°æŠ“å–çš„æ•°æ®
6. **è½åœ°é¡µç®¡ç†æ¨¡å—**ï¼šå­˜å‚¨å’Œç®¡ç†æ‰€æœ‰è½åœ°é¡µ
7. **æŠ•æ”¾ç®¡ç†æ¨¡å—**ï¼šå­˜å‚¨å’Œç®¡ç†æ‰€æœ‰ Campaign/Adset/Ad æ•°æ®
8. **MCP Server æ¨¡å—**ï¼šä¸º AI Agent æä¾›æ•°æ®è®¿é—®æ¥å£

### ç³»ç»Ÿæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    User Portal (ç”¨æˆ·å…¥å£)                    â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              å‰ç«¯ç•Œé¢ (Next.js)                    â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚    â”‚
â”‚  â”‚  â”‚Dashboard â”‚  â”‚ç´ æç®¡ç†  â”‚  â”‚æŠ¥è¡¨ç®¡ç†  â”‚       â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚    â”‚
â”‚  â”‚  â”‚    ç»Ÿä¸€ AI Agent å¯¹è¯ç•Œé¢ (åµŒå…¥å¼)      â”‚     â”‚    â”‚
â”‚  â”‚  â”‚                                          â”‚     â”‚    â”‚
â”‚  â”‚  â”‚  ç”¨æˆ·: å¸®æˆ‘ç”Ÿæˆç´ æå¹¶åˆ›å»ºå¹¿å‘Š            â”‚     â”‚    â”‚
â”‚  â”‚  â”‚  AI: å¥½çš„ï¼æ­£åœ¨ä¸ºä½ å¤„ç†...              â”‚     â”‚    â”‚
â”‚  â”‚  â”‚                                          â”‚     â”‚    â”‚
â”‚  â”‚  â”‚  [WebSocket å®æ—¶é€šä¿¡]                   â”‚     â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                          â”‚                                 â”‚
â”‚                          â”‚ HTTP / WebSocket                â”‚
â”‚                          â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              åç«¯æœåŠ¡ (FastAPI)                    â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚    â”‚
â”‚  â”‚  â”‚ç”¨æˆ·è®¤è¯  â”‚  â”‚è®¢é˜…è®¡è´¹  â”‚  â”‚è´¦æˆ·ç®¡ç†  â”‚       â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚    â”‚
â”‚  â”‚  â”‚ç´ æç®¡ç†  â”‚  â”‚æŠ¥è¡¨æ•°æ®  â”‚  â”‚è½åœ°é¡µåº“  â”‚       â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚    â”‚
â”‚  â”‚  â”‚         MCP Server                       â”‚     â”‚    â”‚
â”‚  â”‚  â”‚  (ä¸º AI Agent æä¾›æ•°æ®è®¿é—®å·¥å…·)          â”‚     â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                          â”‚                                 â”‚
â”‚                          â”‚ PostgreSQL + Redis + S3         â”‚
â”‚                          â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              æ•°æ®å­˜å‚¨å±‚                            â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  - PostgreSQL 14 (ä¸šåŠ¡æ•°æ®)                       â”‚    â”‚
â”‚  â”‚  - TimescaleDB (æ—¶åºæ•°æ®)                         â”‚    â”‚
â”‚  â”‚  - Redis (ç¼“å­˜ + ä¼šè¯)                            â”‚    â”‚
â”‚  â”‚  - AWS S3 (æ–‡ä»¶å­˜å‚¨)                              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â”‚ MCP Protocol
                          â”‚
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚  ç»Ÿä¸€ AI Agent â”‚
                  â”‚  (ç‹¬ç«‹æœåŠ¡)    â”‚
                  â”‚                â”‚
                  â”‚  - æ„å›¾è¯†åˆ«    â”‚
                  â”‚  - åè°ƒå™¨      â”‚
                  â”‚  - 5ç§èƒ½åŠ›æ¨¡å— â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## éœ€æ±‚ï¼ˆRequirementsï¼‰

### éœ€æ±‚ 1ï¼šç”¨æˆ·è®¤è¯ä¸è®¤è¯

**ç”¨æˆ·æ•…äº‹**ï¼šä½œä¸ºä¸€ä¸ªç”µå•†å–å®¶ï¼Œæˆ‘æƒ³è¦æ³¨å†Œå¹¶ç™»å½• AAE ç³»ç»Ÿï¼Œä»¥ä¾¿ä½¿ç”¨ AI Agent å’Œå¹¿å‘Šç®¡ç†åŠŸèƒ½ã€‚

#### éªŒæ”¶æ ‡å‡†
1. WHEN ç”¨æˆ·ä½¿ç”¨ Google OAuth / facebook ç™»å½• THEN User Portal SHALL è‡ªåŠ¨åˆ›å»ºæˆ–ç™»å½•ç”¨æˆ·è´¦æˆ·

---

### éœ€æ±‚ 2ï¼šå¹¿å‘Šè´¦æˆ·ç»‘å®š

**ç”¨æˆ·æ•…äº‹**ï¼šä½œä¸ºä¸€ä¸ªç”¨æˆ·ï¼Œæˆ‘æƒ³è¦ç»‘å®šæˆ‘çš„ Meta/TikTok/Google å¹¿å‘Šè´¦æˆ·ï¼Œä»¥ä¾¿ç³»ç»Ÿå¯ä»¥ç®¡ç†æˆ‘çš„å¹¿å‘Šã€‚

#### éªŒæ”¶æ ‡å‡†

1. WHEN ç”¨æˆ·ç‚¹å‡»"ç»‘å®šå¹¿å‘Šè´¦æˆ·"æŒ‰é’® THEN User Portal SHALL å¯åŠ¨ OAuth æˆæƒæµç¨‹
2. WHEN ç”¨æˆ·å®Œæˆ OAuth æˆæƒ THEN User Portal SHALL å­˜å‚¨åŠ å¯†çš„è®¿é—®ä»¤ç‰Œ
3. WHEN è®¿é—®ä»¤ç‰Œè¿‡æœŸ THEN User Portal SHALL è‡ªåŠ¨åˆ·æ–°ä»¤ç‰Œ
4. WHEN ä»¤ç‰Œåˆ·æ–°å¤±è´¥ THEN User Portal SHALL é€šçŸ¥ç”¨æˆ·é‡æ–°æˆæƒ
5. WHEN ç”¨æˆ·ç»‘å®šå¤šä¸ªå¹¿å‘Šè´¦æˆ· THEN User Portal SHALL å…è®¸ç”¨æˆ·åœ¨è´¦æˆ·ä¹‹é—´åˆ‡æ¢

---

### éœ€æ±‚ 3ï¼šè®¢é˜…ç®¡ç†ï¼ˆCredit è®¡è´¹æ¨¡å¼ï¼‰

**ç”¨æˆ·æ•…äº‹**ï¼šä½œä¸ºä¸€ä¸ªç”¨æˆ·ï¼Œæˆ‘æƒ³è¦è®¢é˜…ä»˜è´¹å¥—é¤è·å– Credit é¢åº¦ï¼Œä»¥ä¾¿ä½¿ç”¨ AI åŠŸèƒ½ã€‚

#### è®¡è´¹æ¨¡å¼è¯´æ˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Credit è®¡è´¹æ¨¡å¼                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  å¥—é¤ç±»å‹ï¼š                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚  â”‚   æ ‡å‡†ç‰ˆ Â¥199   â”‚    â”‚   ä¸“ä¸šç‰ˆ Â¥1999  â”‚                    â”‚
â”‚  â”‚                 â”‚    â”‚                 â”‚                    â”‚
â”‚  â”‚  30,000 Credits â”‚    â”‚ 400,000 Credits â”‚                    â”‚
â”‚  â”‚     /æœˆ         â”‚    â”‚      /æœˆ        â”‚                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                                                                 â”‚
â”‚  Credit æ¶ˆè€—è§„åˆ™ï¼ˆå¯é…ç½®ï¼‰ï¼š                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚  â”‚ æ“ä½œç±»å‹              â”‚ Credit æ¶ˆè€—     â”‚                    â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚
â”‚  â”‚ æ™®é€šå¯¹è¯ï¼ˆ~2K tokensï¼‰ â”‚ 1 credit       â”‚                    â”‚
â”‚  â”‚ å¤æ‚åˆ†æï¼ˆ~10K tokensï¼‰â”‚ 5 credits      â”‚                    â”‚
â”‚  â”‚ ç´ æç”Ÿæˆï¼ˆæ¯å¼ å›¾ï¼‰     â”‚ 2 credits      â”‚                    â”‚
â”‚  â”‚ è½åœ°é¡µç”Ÿæˆ            â”‚ 30 credits     â”‚                    â”‚
â”‚  â”‚ å¹¿å‘Šç­–ç•¥åˆ†æ          â”‚ 10 credits     â”‚                    â”‚
â”‚  â”‚ ç«å“åˆ†æ              â”‚ 15 credits     â”‚                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                                                                 â”‚
â”‚  è¶…é¢è®¡è´¹ï¼š                                                      â”‚
â”‚  - Credit ç”¨å®ŒåæŒ‰ Â¥0.01/credit å®æ—¶æ‰£è´¹                        â”‚
â”‚  - éœ€ç”¨æˆ·é¢„å…ˆå……å€¼æˆ–ç»‘å®šæ”¯ä»˜æ–¹å¼                                   â”‚
â”‚                                                                 â”‚
â”‚  Credit æ¢ç®—é€»è¾‘ï¼ˆåå°å¯é…ç½®ï¼‰ï¼š                                  â”‚
â”‚  - åŸºäº AI æ¨¡å‹ token æ¶ˆè€—æ¢ç®—                                   â”‚
â”‚  - ä¸åŒæ¨¡å‹æœ‰ä¸åŒæ¢ç®—ç³»æ•°                                        â”‚
â”‚  - æ”¯æŒåŠ¨æ€è°ƒæ•´æ¢ç®—è§„åˆ™                                          â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### éªŒæ”¶æ ‡å‡†

1. WHEN ç”¨æˆ·é€‰æ‹©è®¢é˜…å¥—é¤ THEN User Portal SHALL æ˜¾ç¤ºå¥—é¤è¯¦æƒ…ã€ä»·æ ¼å’Œ Credit é¢åº¦
2. WHEN ç”¨æˆ·å®Œæˆæ”¯ä»˜ THEN User Portal SHALL æ¿€æ´»è®¢é˜…å¹¶å……å€¼å¯¹åº” Credit é¢åº¦
3. WHEN è®¢é˜…åˆ°æœŸå‰ 7 å¤©å’Œ 3 å¤© THEN User Portal SHALL å‘é€ç»­è´¹æé†’é‚®ä»¶
4. WHEN ç”¨æˆ·å–æ¶ˆè®¢é˜… THEN User Portal SHALL åœ¨å½“å‰è®¡è´¹å‘¨æœŸç»“æŸååœæ­¢æœåŠ¡ï¼ˆå‰©ä½™ Credit ä¿ç•™è‡³å‘¨æœŸç»“æŸï¼‰
5. WHEN ç”¨æˆ·å‡çº§å¥—é¤ THEN User Portal SHALL ç«‹å³ç”Ÿæ•ˆï¼Œè¡¥å……å·®é¢ Credit
6. WHEN ç”¨æˆ·ç»­è´¹ THEN User Portal SHALL é‡ç½® Credit é¢åº¦ï¼ˆä¸ç´¯ç§¯ä¸Šæœˆå‰©ä½™ï¼‰

---

### éœ€æ±‚ 3.1ï¼šCredit æ¶ˆè€—ä¸è®¡ç®—

**ç”¨æˆ·æ•…äº‹**ï¼šä½œä¸ºç³»ç»Ÿï¼Œæˆ‘éœ€è¦æ ¹æ® AI æ¨¡å‹å®é™…æ¶ˆè€—è®¡ç®— Creditï¼Œä»¥ä¾¿ç²¾ç¡®è®¡è´¹ã€‚

#### Credit æ¢ç®—è§„åˆ™ï¼ˆå¯é…ç½®ï¼‰

| AI æ¨¡å‹ | Token ç±»å‹ | æ¢ç®—æ¯”ä¾‹ï¼ˆæ¯1K tokensï¼‰ |
|---------|-----------|------------------------|
| Gemini 2.5 Flash | Input | 0.1 credit |
| Gemini 2.5 Flash | Output | 0.4 credit |
| Claude 3.5 Sonnet | Input | 2 credits |
| Claude 3.5 Sonnet | Output | 10 credits |
| Stable Diffusion XL | æ¯å¼ å›¾ç‰‡ | 2 credits |

#### éªŒæ”¶æ ‡å‡†

1. WHEN AI Agent å®Œæˆä¸€æ¬¡è°ƒç”¨ THEN User Portal SHALL æ ¹æ®å®é™… token æ¶ˆè€—è®¡ç®— Credit
2. WHEN è®¡ç®— Credit THEN User Portal SHALL ä½¿ç”¨åå°é…ç½®çš„æ¢ç®—è§„åˆ™
3. WHEN æ¢ç®—è§„åˆ™æ›´æ–° THEN User Portal SHALL å¯¹æ–°è¯·æ±‚ç”Ÿæ•ˆï¼ˆä¸è¿½æº¯å†å²ï¼‰
4. WHEN Credit æ¶ˆè€— THEN User Portal SHALL å®æ—¶æ‰£å‡ç”¨æˆ·ä½™é¢
5. WHEN æ‰£å‡å¤±è´¥ THEN User Portal SHALL å›æ»šæ“ä½œå¹¶è¿”å›é”™è¯¯

---

### éœ€æ±‚ 3.2ï¼šè¶…é¢æŒ‰æ¬¡æ”¶è´¹

**ç”¨æˆ·æ•…äº‹**ï¼šä½œä¸ºç”¨æˆ·ï¼Œæˆ‘å¸Œæœ› Credit ç”¨å®Œåå¯ä»¥ç»§ç»­ä½¿ç”¨ï¼ŒæŒ‰å®é™…ç”¨é‡ä»˜è´¹ã€‚

#### éªŒæ”¶æ ‡å‡†

1. WHEN ç”¨æˆ· Credit ä½™é¢ä¸è¶³ THEN User Portal SHALL æ£€æŸ¥æ˜¯å¦å¼€å¯è¶…é¢ä»˜è´¹
2. WHEN è¶…é¢ä»˜è´¹å·²å¼€å¯ä¸”æœ‰æ”¯ä»˜æ–¹å¼ THEN User Portal SHALL å…è®¸ç»§ç»­ä½¿ç”¨å¹¶è®°å½•æ¬ è´¹
3. WHEN è¶…é¢æ¶ˆè´¹ç´¯è®¡è¾¾åˆ°é˜ˆå€¼ï¼ˆå¦‚ Â¥100ï¼‰ THEN User Portal SHALL è‡ªåŠ¨æ‰£æ¬¾
4. WHEN è‡ªåŠ¨æ‰£æ¬¾å¤±è´¥ THEN User Portal SHALL æš‚åœæœåŠ¡å¹¶é€šçŸ¥ç”¨æˆ·
5. WHEN ç”¨æˆ·æœªå¼€å¯è¶…é¢ä»˜è´¹ä¸” Credit ä¸è¶³ THEN User Portal SHALL è¿”å›ä½™é¢ä¸è¶³é”™è¯¯å¹¶æç¤ºå……å€¼

---

### éœ€æ±‚ 3.3ï¼šCredit å……å€¼

**ç”¨æˆ·æ•…äº‹**ï¼šä½œä¸ºç”¨æˆ·ï¼Œæˆ‘æƒ³è¦éšæ—¶å……å€¼ Creditï¼Œä»¥ä¾¿åœ¨å¥—é¤é¢åº¦ç”¨å®Œåç»§ç»­ä½¿ç”¨ã€‚

#### éªŒæ”¶æ ‡å‡†

1. WHEN ç”¨æˆ·é€‰æ‹©å……å€¼ THEN User Portal SHALL æ˜¾ç¤ºå……å€¼é‡‘é¢é€‰é¡¹ï¼ˆÂ¥50/Â¥100/Â¥500/è‡ªå®šä¹‰ï¼‰
2. WHEN ç”¨æˆ·å®Œæˆå……å€¼æ”¯ä»˜ THEN User Portal SHALL æŒ‰ Â¥0.01/credit æ¢ç®—å¹¶å……å€¼
3. WHEN å……å€¼å®Œæˆ THEN User Portal SHALL ç«‹å³åˆ°è´¦å¯ç”¨
4. WHEN ç”¨æˆ·æœ‰å……å€¼ä½™é¢å’Œå¥—é¤ä½™é¢ THEN User Portal SHALL ä¼˜å…ˆæ¶ˆè€—å¥—é¤ä½™é¢
5. WHEN å……å€¼ä½™é¢ THEN User Portal SHALL ä¸è¿‡æœŸï¼Œå¯è·¨æœˆä½¿ç”¨

---

### éœ€æ±‚ 4ï¼šDashboard ä»ªè¡¨æ¿

**ç”¨æˆ·æ•…äº‹**ï¼šä½œä¸ºä¸€ä¸ªç”¨æˆ·ï¼Œæˆ‘æƒ³è¦åœ¨ Dashboard æŸ¥çœ‹å…³é”®æŒ‡æ ‡å’Œå¿«é€Ÿæ“ä½œï¼Œä»¥ä¾¿é«˜æ•ˆç®¡ç†å¹¿å‘Šã€‚

#### éªŒæ”¶æ ‡å‡†

1. WHEN ç”¨æˆ·ç™»å½•å THEN User Portal SHALL æ˜¾ç¤º Dashboard é¡µé¢
2. WHEN Dashboard åŠ è½½ THEN User Portal SHALL æ˜¾ç¤ºä»Šæ—¥å’Œæ˜¨æ—¥çš„æ ¸å¿ƒæŒ‡æ ‡ï¼ˆèŠ±è´¹/ROAS/CPAï¼‰
3. WHEN Dashboard åŠ è½½ THEN User Portal SHALL æ˜¾ç¤ºè¿‘ 7 å¤©çš„è¶‹åŠ¿å›¾è¡¨
4. WHEN Dashboard åŠ è½½ THEN User Portal SHALL æ˜¾ç¤º AI æ™ºèƒ½å»ºè®®å¡ç‰‡
5. WHEN Dashboard åŠ è½½ THEN User Portal SHALL åœ¨å³ä¸‹è§’æ˜¾ç¤º AI Agent å¯¹è¯å…¥å£

---

### éœ€æ±‚ 4.1ï¼šåµŒå…¥å¼ AI Agent å¯¹è¯ç•Œé¢

**ç”¨æˆ·æ•…äº‹**ï¼šä½œä¸ºä¸€ä¸ªç”¨æˆ·ï¼Œæˆ‘æƒ³è¦åœ¨ä¸»ç«™ä»»ä½•é¡µé¢éƒ½èƒ½ä¸ AI Agent å¯¹è¯ï¼Œä»¥ä¾¿éšæ—¶è·å¾—å¸®åŠ©ã€‚

#### éªŒæ”¶æ ‡å‡†

1. WHEN ç”¨æˆ·è®¿é—®ä»»ä½•é¡µé¢ THEN User Portal SHALL åœ¨å³ä¸‹è§’æ˜¾ç¤ºå¯¹è¯å›¾æ ‡
2. WHEN ç”¨æˆ·ç‚¹å‡»å¯¹è¯å›¾æ ‡ THEN User Portal SHALL å±•å¼€å¯¹è¯çª—å£
3. WHEN å¯¹è¯çª—å£å±•å¼€ THEN User Portal SHALL é€šè¿‡ WebSocket è¿æ¥åˆ° AI Agent
4. WHEN ç”¨æˆ·å‘é€æ¶ˆæ¯ THEN User Portal SHALL å®æ—¶æ˜¾ç¤º AI Agent çš„å›å¤
5. WHEN ç”¨æˆ·å…³é—­å¯¹è¯çª—å£ THEN User Portal SHALL ä¿å­˜å¯¹è¯å†å²

---

### éœ€æ±‚ 4.2ï¼šå¯¹è¯ç•Œé¢åŠŸèƒ½

**ç”¨æˆ·æ•…äº‹**ï¼šä½œä¸ºä¸€ä¸ªç”¨æˆ·ï¼Œæˆ‘æƒ³è¦å¯¹è¯ç•Œé¢æä¾›ä¸°å¯Œçš„åŠŸèƒ½ï¼Œä»¥ä¾¿æ›´å¥½åœ°ä¸ AI äº¤äº’ã€‚

#### éªŒæ”¶æ ‡å‡†

1. WHEN ç”¨æˆ·è¾“å…¥æ¶ˆæ¯ THEN User Portal SHALL æ”¯æŒæ–‡æœ¬ã€å›¾ç‰‡ã€é“¾æ¥è¾“å…¥
2. WHEN AI å›å¤ THEN User Portal SHALL æ”¯æŒæµå¼æ˜¾ç¤ºï¼ˆStreamingï¼‰
3. WHEN AI æä¾›æ“ä½œå»ºè®® THEN User Portal SHALL æ˜¾ç¤ºå¯ç‚¹å‡»çš„æŒ‰é’®
4. WHEN ç”¨æˆ·ç‚¹å‡»å»ºè®®æŒ‰é’® THEN User Portal SHALL è‡ªåŠ¨æ‰§è¡Œå¯¹åº”æ“ä½œ
5. WHEN å¯¹è¯æ¶‰åŠæ•°æ® THEN User Portal SHALL åœ¨å¯¹è¯ä¸­åµŒå…¥å›¾è¡¨å’Œå¡ç‰‡

---

### éœ€æ±‚ 5ï¼šç”¨æˆ·è®¾ç½®

**ç”¨æˆ·æ•…äº‹**ï¼šä½œä¸ºä¸€ä¸ªç”¨æˆ·ï¼Œæˆ‘æƒ³è¦ç®¡ç†æˆ‘çš„è´¦æˆ·è®¾ç½®ï¼Œä»¥ä¾¿è‡ªå®šä¹‰ç³»ç»Ÿè¡Œä¸ºã€‚

#### éªŒæ”¶æ ‡å‡†

1. WHEN ç”¨æˆ·è®¿é—®è®¾ç½®é¡µé¢ THEN User Portal SHALL æ˜¾ç¤ºä¸ªäººä¿¡æ¯ã€é€šçŸ¥åå¥½ã€å®‰å…¨è®¾ç½®
2. WHEN ç”¨æˆ·ä¿®æ”¹ä¸ªäººä¿¡æ¯ THEN User Portal SHALL éªŒè¯å¹¶ä¿å­˜æ›´æ”¹
3. WHEN ç”¨æˆ·ä¿®æ”¹é€šçŸ¥åå¥½ THEN User Portal SHALL æ›´æ–°é€šçŸ¥è§„åˆ™
4. WHEN ç”¨æˆ·åˆ é™¤è´¦æˆ· THEN User Portal SHALL è¦æ±‚ç¡®è®¤å¹¶åˆ é™¤æ‰€æœ‰ç”¨æˆ·æ•°æ®

---

### éœ€æ±‚ 6ï¼šè®¡è´¹

**ç”¨æˆ·æ•…äº‹**ï¼šä½œä¸ºä¸€ä¸ªç”¨æˆ·ï¼Œæˆ‘æƒ³è¦æŸ¥çœ‹æˆ‘çš„è´¦å•å†å²ï¼Œä»¥ä¾¿è¿›è¡Œè´¢åŠ¡ç®¡ç†ã€‚

#### éªŒæ”¶æ ‡å‡†

1. WHEN ç”¨æˆ·è®¿é—®è®¡è´¹é¡µé¢ THEN User Portal SHALL æ˜¾ç¤ºå½“å‰è®¢é˜…çŠ¶æ€å’Œä¸‹æ¬¡æ‰£æ¬¾æ—¥æœŸ
2. WHEN ç”¨æˆ·è®¿é—®è®¡è´¹é¡µé¢ THEN User Portal SHALL æ˜¾ç¤ºå†å²è´¦å•åˆ—è¡¨
3. WHEN è®¢é˜…æ‰£æ¬¾æˆåŠŸ THEN User Portal SHALL è‡ªåŠ¨å‘é€è®¢é˜…ä¿¡æ¯åˆ°ç”¨æˆ·é‚®ç®±
5. WHEN è®¢é˜…æ‰£æ¬¾å¤±è´¥ THEN User Portal SHALL å‘é€æ”¯ä»˜å¤±è´¥é€šçŸ¥å¹¶æš‚åœæœåŠ¡

---

### éœ€æ±‚ 7ï¼šç´ æç®¡ç†æ¨¡å—

**ç”¨æˆ·æ•…äº‹**ï¼šä½œä¸ºç³»ç»Ÿï¼Œæˆ‘éœ€è¦æä¾›ç»Ÿä¸€çš„ç´ æç®¡ç†åŠŸèƒ½ï¼Œä»¥ä¾¿ Creative Agent å’Œå…¶ä»– Agent è®¿é—®ç´ ææ•°æ®ã€‚

#### éªŒæ”¶æ ‡å‡†

1. WHEN Creative Agent ç”Ÿæˆç´ æ THEN User Portal SHALL å­˜å‚¨ç´ æå…ƒæ•°æ®åˆ°æ•°æ®åº“
2. WHEN ç´ ææ–‡ä»¶ä¸Šä¼  THEN User Portal SHALL å­˜å‚¨æ–‡ä»¶åˆ° AWS S3
3. WHEN Agent è¯·æ±‚ç´ æåˆ—è¡¨ THEN User Portal SHALL è¿”å›ç”¨æˆ·çš„æ‰€æœ‰ç´ æ
4. WHEN Agent è¯·æ±‚ç´ æè¯¦æƒ… THEN User Portal SHALL è¿”å›ç´ æçš„å®Œæ•´ä¿¡æ¯ï¼ˆURLã€è¯„åˆ†ã€æ ‡ç­¾ï¼‰
5. WHEN Agent åˆ é™¤ç´ æ THEN User Portal SHALL åˆ é™¤æ•°æ®åº“è®°å½•å’Œ S3 æ–‡ä»¶

---

### éœ€æ±‚ 8ï¼šæŠ¥è¡¨æ•°æ®æ¨¡å—

**ç”¨æˆ·æ•…äº‹**ï¼šä½œä¸ºç³»ç»Ÿï¼Œæˆ‘éœ€è¦å­˜å‚¨å’Œç®¡ç†æ‰€æœ‰å¹¿å‘Šå¹³å°çš„æ•°æ®ï¼Œä»¥ä¾¿ Reporting Agent å’Œå…¶ä»– Agent è®¿é—®ã€‚

#### éªŒæ”¶æ ‡å‡†

1. WHEN Reporting Agent æŠ“å–æ•°æ® THEN User Portal SHALL å­˜å‚¨åˆ° TimescaleDB æ—¶åºè¡¨
2. WHEN Agent è¯·æ±‚æŠ¥è¡¨æ•°æ® THEN User Portal SHALL è¿”å›æŒ‡å®šæ—¶é—´èŒƒå›´çš„æ•°æ®
3. WHEN Agent è¯·æ±‚æ±‡æ€»æ•°æ® THEN User Portal SHALL è¿”å›èšåˆåçš„æŒ‡æ ‡
4. WHEN æ•°æ®è¶…è¿‡ 90 å¤© THEN User Portal SHALL è‡ªåŠ¨å½’æ¡£åˆ°æ±‡æ€»è¡¨
5. WHEN Agent è¯·æ±‚è¶‹åŠ¿åˆ†æ THEN User Portal SHALL è¿”å›æ—¶åºæ•°æ®

---

### éœ€æ±‚ 9ï¼šè½åœ°é¡µç®¡ç†æ¨¡å—

**ç”¨æˆ·æ•…äº‹**ï¼šä½œä¸ºç³»ç»Ÿï¼Œæˆ‘éœ€è¦ç®¡ç†æ‰€æœ‰è½åœ°é¡µæ•°æ®ï¼Œä»¥ä¾¿ Landing Page Agent å’Œå…¶ä»– Agent è®¿é—®ã€‚

#### éªŒæ”¶æ ‡å‡†

1. WHEN Landing Page Agent ç”Ÿæˆè½åœ°é¡µ THEN User Portal SHALL å­˜å‚¨è½åœ°é¡µé…ç½®åˆ°æ•°æ®åº“
2. WHEN è½åœ°é¡µå‘å¸ƒ THEN User Portal SHALL ä¸Šä¼  HTML åˆ° S3 å¹¶é…ç½® CloudFront
3. WHEN Agent è¯·æ±‚è½åœ°é¡µåˆ—è¡¨ THEN User Portal SHALL è¿”å›ç”¨æˆ·çš„æ‰€æœ‰è½åœ°é¡µ
4. WHEN Agent è¯·æ±‚è½åœ°é¡µæ•°æ® THEN User Portal SHALL è¿”å›è½åœ°é¡µçš„è½¬åŒ–æ•°æ®
5. WHEN Agent æ›´æ–°è½åœ°é¡µ THEN User Portal SHALL æ›´æ–°æ•°æ®åº“å’Œé‡æ–°éƒ¨ç½²

---

### éœ€æ±‚ 10ï¼šæŠ•æ”¾ç®¡ç†æ¨¡å—

**ç”¨æˆ·æ•…äº‹**ï¼šä½œä¸ºç³»ç»Ÿï¼Œæˆ‘éœ€è¦ç®¡ç†æ‰€æœ‰å¹¿å‘ŠæŠ•æ”¾æ•°æ®ï¼Œä»¥ä¾¿ Automated Ad Engine Agent å’Œå…¶ä»– Agent è®¿é—®ã€‚

#### éªŒæ”¶æ ‡å‡†

1. WHEN Automated Ad Engine Agent åˆ›å»ºå¹¿å‘Š THEN User Portal SHALL å­˜å‚¨ Campaign/Adset/Ad ç»“æ„
2. WHEN Agent è¯·æ±‚æŠ•æ”¾åˆ—è¡¨ THEN User Portal SHALL è¿”å›ç”¨æˆ·çš„æ‰€æœ‰æŠ•æ”¾
3. WHEN Agent ä¿®æ”¹æŠ•æ”¾ THEN User Portal SHALL æ›´æ–°æ•°æ®åº“å¹¶åŒæ­¥åˆ°å¹¿å‘Šå¹³å°
4. WHEN Agent è¯·æ±‚æŠ•æ”¾çŠ¶æ€ THEN User Portal SHALL è¿”å›å®æ—¶çŠ¶æ€
5. WHEN Agent åˆ é™¤æŠ•æ”¾ THEN User Portal SHALL æ ‡è®°ä¸ºåˆ é™¤å¹¶ä¿ç•™å†å²è®°å½•

---

### éœ€æ±‚ 11ï¼šAgent API æ¥å£

**ç”¨æˆ·æ•…äº‹**ï¼šä½œä¸ºç³»ç»Ÿï¼Œæˆ‘éœ€è¦ä¸º 5 ä¸ª AI Agent æä¾›ç»Ÿä¸€çš„ API æ¥å£ï¼Œä»¥ä¾¿ Agent è®¿é—®æ•°æ®ã€‚

#### éªŒæ”¶æ ‡å‡†

1. WHEN Agent è°ƒç”¨ API THEN User Portal SHALL éªŒè¯ Agent èº«ä»½å’Œæƒé™
2. WHEN Agent è¯·æ±‚æ•°æ® THEN User Portal SHALL è¿”å› JSON æ ¼å¼çš„æ•°æ®
3. WHEN Agent å†™å…¥æ•°æ® THEN User Portal SHALL éªŒè¯æ•°æ®æ ¼å¼å¹¶å­˜å‚¨
4. WHEN API è°ƒç”¨å¤±è´¥ THEN User Portal SHALL è¿”å›æ¸…æ™°çš„é”™è¯¯ä¿¡æ¯
5. WHEN API è°ƒç”¨é¢‘ç¹ THEN User Portal SHALL å®æ–½ Rate Limiting

---

### éœ€æ±‚ 12ï¼šAI Agent é€šä¿¡ï¼ˆMCPï¼‰

**ç”¨æˆ·æ•…äº‹**ï¼šä½œä¸ºç³»ç»Ÿï¼Œæˆ‘éœ€è¦ä¸º AI Agent æä¾› MCP Serverï¼Œä»¥ä¾¿ Agent è®¿é—®æ•°æ®ã€‚

#### éªŒæ”¶æ ‡å‡†

1. WHEN AI Agent å¯åŠ¨ THEN User Portal SHALL æ¥å— MCP è¿æ¥
2. WHEN AI Agent è°ƒç”¨å·¥å…· THEN User Portal SHALL éªŒè¯æƒé™å¹¶æ‰§è¡Œ
3. WHEN å·¥å…·æ‰§è¡ŒæˆåŠŸ THEN User Portal SHALL è¿”å›ç»“æœç»™ AI Agent
4. WHEN å·¥å…·æ‰§è¡Œå¤±è´¥ THEN User Portal SHALL è¿”å›é”™è¯¯ä¿¡æ¯
5. WHEN AI Agent æ–­å¼€è¿æ¥ THEN User Portal SHALL æ¸…ç†ä¼šè¯çŠ¶æ€

---

### éœ€æ±‚ 12.1ï¼šWebSocket å®æ—¶é€šä¿¡

**ç”¨æˆ·æ•…äº‹**ï¼šä½œä¸ºç³»ç»Ÿï¼Œæˆ‘éœ€è¦é€šè¿‡ WebSocket ä¸ AI Agent å®æ—¶é€šä¿¡ï¼Œä»¥ä¾¿æä¾›æµç•…çš„å¯¹è¯ä½“éªŒã€‚

#### éªŒæ”¶æ ‡å‡†

1. WHEN ç”¨æˆ·æ‰“å¼€å¯¹è¯çª—å£ THEN User Portal SHALL å»ºç«‹ WebSocket è¿æ¥
2. WHEN ç”¨æˆ·å‘é€æ¶ˆæ¯ THEN User Portal SHALL é€šè¿‡ WebSocket å‘é€åˆ° AI Agent
3. WHEN AI Agent å›å¤ THEN User Portal SHALL é€šè¿‡ WebSocket æ¥æ”¶å¹¶æ˜¾ç¤º
4. WHEN è¿æ¥æ–­å¼€ THEN User Portal SHALL è‡ªåŠ¨é‡è¿
5. WHEN é‡è¿å¤±è´¥ THEN User Portal SHALL æç¤ºç”¨æˆ·åˆ·æ–°é¡µé¢

---

### éœ€æ±‚ 13ï¼šCredit ä½™é¢ç®¡ç†

**ç”¨æˆ·æ•…äº‹**ï¼šä½œä¸ºç³»ç»Ÿï¼Œæˆ‘éœ€è¦ç®¡ç†ç”¨æˆ·çš„ Credit ä½™é¢ï¼Œä»¥ä¾¿å®ç°ç²¾ç¡®è®¡è´¹ã€‚

#### Credit ä½™é¢æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ç”¨æˆ· Credit ä½™é¢ç»“æ„                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  ç”¨æˆ·è´¦æˆ·                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                                                          â”‚   â”‚
â”‚  â”‚  å¥—é¤ä½™é¢ï¼ˆsubscription_creditsï¼‰                         â”‚   â”‚
â”‚  â”‚  - æ¯æœˆé‡ç½®                                              â”‚   â”‚
â”‚  â”‚  - ä¸å¯è·¨æœˆç´¯ç§¯                                          â”‚   â”‚
â”‚  â”‚  - ä¼˜å…ˆæ¶ˆè€—                                              â”‚   â”‚
â”‚  â”‚                                                          â”‚   â”‚
â”‚  â”‚  å……å€¼ä½™é¢ï¼ˆpurchased_creditsï¼‰                            â”‚   â”‚
â”‚  â”‚  - æ°¸ä¸è¿‡æœŸ                                              â”‚   â”‚
â”‚  â”‚  - å¥—é¤ä½™é¢ç”¨å®Œåæ¶ˆè€—                                     â”‚   â”‚
â”‚  â”‚                                                          â”‚   â”‚
â”‚  â”‚  å¯ç”¨ä½™é¢ = å¥—é¤ä½™é¢ + å……å€¼ä½™é¢                            â”‚   â”‚
â”‚  â”‚                                                          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚  æ¶ˆè€—é¡ºåºï¼šå¥—é¤ä½™é¢ â†’ å……å€¼ä½™é¢ â†’ è¶…é¢æ‰£è´¹                        â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### éªŒæ”¶æ ‡å‡†

1. WHEN AI Agent è°ƒç”¨ MCP å·¥å…· THEN User Portal SHALL é¦–å…ˆæ£€æŸ¥ç”¨æˆ· Credit ä½™é¢
2. WHEN Credit ä½™é¢å……è¶³ THEN User Portal SHALL æ‰§è¡Œå·¥å…·å¹¶æ‰£å‡ Credit
3. WHEN Credit ä½™é¢ä¸è¶³ä½†å¼€å¯è¶…é¢ä»˜è´¹ THEN User Portal SHALL æ‰§è¡Œå·¥å…·å¹¶è®°å½•æ¬ è´¹
4. WHEN Credit ä½™é¢ä¸è¶³ä¸”æœªå¼€å¯è¶…é¢ä»˜è´¹ THEN User Portal SHALL è¿”å›ä½™é¢ä¸è¶³é”™è¯¯ï¼ˆerror_code: 6011ï¼‰
5. WHEN ç”¨æˆ·è®¢é˜…è¿‡æœŸ THEN User Portal SHALL æ¸…é›¶å¥—é¤ä½™é¢ï¼Œä¿ç•™å……å€¼ä½™é¢

---

### éœ€æ±‚ 13.1ï¼šCredit æ¶ˆè€—è®°å½•

**ç”¨æˆ·æ•…äº‹**ï¼šä½œä¸ºç”¨æˆ·ï¼Œæˆ‘æƒ³è¦æŸ¥çœ‹ Credit æ¶ˆè€—æ˜ç»†ï¼Œä»¥ä¾¿äº†è§£ä½¿ç”¨æƒ…å†µã€‚

#### éªŒæ”¶æ ‡å‡†

1. WHEN Credit è¢«æ¶ˆè€— THEN User Portal SHALL è®°å½•æ¶ˆè€—æ˜ç»†ï¼ˆæ—¶é—´ã€æ“ä½œç±»å‹ã€æ¶ˆè€—é‡ã€æ¨¡å‹ã€tokenæ•°ï¼‰
2. WHEN ç”¨æˆ·æŸ¥çœ‹æ¶ˆè€—è®°å½• THEN User Portal SHALL æ˜¾ç¤ºæœ€è¿‘ 30 å¤©çš„æ¶ˆè€—æ˜ç»†
3. WHEN ç”¨æˆ·æŸ¥çœ‹æ¶ˆè€—ç»Ÿè®¡ THEN User Portal SHALL æŒ‰æ—¥/å‘¨/æœˆæ±‡æ€»æ¶ˆè€—æ•°æ®
4. WHEN ç”¨æˆ·å¯¼å‡ºè®°å½• THEN User Portal SHALL æ”¯æŒå¯¼å‡º CSV æ ¼å¼
5. WHEN æ¶ˆè€—å¼‚å¸¸ï¼ˆå•æ¬¡ > 1000 creditsï¼‰ THEN User Portal SHALL è®°å½•å‘Šè­¦æ—¥å¿—

---

### éœ€æ±‚ 13.2ï¼šCredit ä½™é¢é¢„è­¦

**ç”¨æˆ·æ•…äº‹**ï¼šä½œä¸ºç”¨æˆ·ï¼Œæˆ‘æƒ³è¦åœ¨ Credit å³å°†ç”¨å®Œæ—¶æ”¶åˆ°æé†’ï¼Œä»¥ä¾¿åŠæ—¶å……å€¼ã€‚

#### éªŒæ”¶æ ‡å‡†

1. WHEN å¥—é¤ä½™é¢ä½äº 20% THEN User Portal SHALL åœ¨ç•Œé¢æ˜¾ç¤ºä½™é¢é¢„è­¦
2. WHEN å¥—é¤ä½™é¢ä½äº 10% THEN User Portal SHALL å‘é€é‚®ä»¶/ç«™å†…é€šçŸ¥
3. WHEN å¥—é¤ä½™é¢è€—å°½ THEN User Portal SHALL å‘é€ç´§æ€¥é€šçŸ¥
4. WHEN ç”¨æˆ·è®¾ç½®é¢„è­¦é˜ˆå€¼ THEN User Portal SHALL æŒ‰ç”¨æˆ·è®¾ç½®è§¦å‘é¢„è­¦
5. WHEN å……å€¼ä½™é¢ä½äº 1000 credits THEN User Portal SHALL æç¤ºç”¨æˆ·å……å€¼

---

### éœ€æ±‚ 13.3ï¼šCredit æ‰£å‡é€»è¾‘

**ç”¨æˆ·æ•…äº‹**ï¼šä½œä¸ºç³»ç»Ÿï¼Œæˆ‘éœ€è¦åœ¨ MCP å·¥å…·è°ƒç”¨æ—¶æ­£ç¡®æ‰£å‡ Creditã€‚

#### éªŒæ”¶æ ‡å‡†

1. WHEN AI Agent è°ƒç”¨ MCP å·¥å…·å‰ THEN User Portal SHALL é¢„ä¼° Credit æ¶ˆè€—å¹¶é¢„æ‰£
2. WHEN å·¥å…·æ‰§è¡Œå®Œæˆ THEN User Portal SHALL æ ¹æ®å®é™…æ¶ˆè€—è°ƒæ•´æ‰£å‡ï¼ˆå¤šé€€å°‘è¡¥ï¼‰
3. WHEN å·¥å…·æ‰§è¡Œå¤±è´¥ THEN User Portal SHALL å…¨é¢é€€è¿˜é¢„æ‰£ Credit
4. WHEN æ‰£å‡ Credit THEN User Portal SHALL ä¼˜å…ˆæ‰£å¥—é¤ä½™é¢ï¼Œå†æ‰£å……å€¼ä½™é¢
5. WHEN å¹¶å‘æ‰£å‡ THEN User Portal SHALL ä½¿ç”¨äº‹åŠ¡ä¿è¯æ•°æ®ä¸€è‡´æ€§

---

### éœ€æ±‚ 14ï¼šè½åœ°é¡µç¼–è¾‘å™¨

**ç”¨æˆ·æ•…äº‹**ï¼šä½œä¸ºç”¨æˆ·ï¼Œæˆ‘æƒ³åœ¨æµè§ˆå™¨ä¸­ç¼–è¾‘è½åœ°é¡µï¼Œä»¥ä¾¿è‡ªå®šä¹‰å†…å®¹å’Œæ ·å¼ã€‚

#### éªŒæ”¶æ ‡å‡†

1. WHEN ç”¨æˆ·æ‰“å¼€è½åœ°é¡µç¼–è¾‘å™¨ THEN User Portal SHALL æ˜¾ç¤ºå¯è§†åŒ–ç¼–è¾‘ç•Œé¢
2. WHEN ç”¨æˆ·ç‚¹å‡»æ–‡æœ¬å…ƒç´  THEN User Portal SHALL å…è®¸ç›´æ¥ç¼–è¾‘æ–‡æœ¬å†…å®¹
3. WHEN ç”¨æˆ·ç‚¹å‡»å›¾ç‰‡å…ƒç´  THEN User Portal SHALL æ˜¾ç¤ºå›¾ç‰‡ä¸Šä¼ ç•Œé¢
4. WHEN ç”¨æˆ·ä¿®æ”¹ä¸»é¢˜é¢œè‰² THEN User Portal SHALL å®æ—¶é¢„è§ˆé¢œè‰²å˜åŒ–
5. WHEN ç”¨æˆ·ä¿å­˜æ›´æ”¹ THEN User Portal SHALL è°ƒç”¨ Landing Page Capability æ›´æ–°è½åœ°é¡µ

---

### éœ€æ±‚ 14.1ï¼šç¼–è¾‘å™¨åŠŸèƒ½

**ç”¨æˆ·æ•…äº‹**ï¼šä½œä¸ºç”¨æˆ·ï¼Œæˆ‘æƒ³è¦ç¼–è¾‘å™¨æä¾›ä¸°å¯Œçš„ç¼–è¾‘åŠŸèƒ½ï¼Œä»¥ä¾¿çµæ´»è‡ªå®šä¹‰ã€‚

#### éªŒæ”¶æ ‡å‡†

1. WHEN ç”¨æˆ·ç¼–è¾‘æ–‡æœ¬ THEN User Portal SHALL æ”¯æŒå¯Œæ–‡æœ¬ç¼–è¾‘ï¼ˆç²—ä½“ã€æ–œä½“ã€é¢œè‰²ï¼‰
2. WHEN ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ THEN User Portal SHALL è‡ªåŠ¨å‹ç¼©å¹¶ä¸Šä¼ åˆ° S3
3. WHEN ç”¨æˆ·ä¿®æ”¹å¸ƒå±€ THEN User Portal SHALL æä¾›æ‹–æ‹½è°ƒæ•´åŠŸèƒ½
4. WHEN ç”¨æˆ·æ’¤é”€æ“ä½œ THEN User Portal SHALL æ”¯æŒæ’¤é”€/é‡åšï¼ˆæœ€å¤š 20 æ­¥ï¼‰
5. WHEN ç”¨æˆ·é¢„è§ˆ THEN User Portal SHALL åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€é¢„è§ˆ

---

### éœ€æ±‚ 15ï¼šæŠ¥è¡¨å¯è§†åŒ–

**ç”¨æˆ·æ•…äº‹**ï¼šä½œä¸ºç”¨æˆ·ï¼Œæˆ‘æƒ³æŸ¥çœ‹å¯è§†åŒ–çš„æŠ¥è¡¨ï¼Œä»¥ä¾¿å¿«é€Ÿäº†è§£å¹¿å‘Šè¡¨ç°ã€‚

#### éªŒæ”¶æ ‡å‡†

1. WHEN ç”¨æˆ·è®¿é—®æŠ¥è¡¨é¡µé¢ THEN User Portal SHALL æ˜¾ç¤ºæ ¸å¿ƒæŒ‡æ ‡å¡ç‰‡ï¼ˆèŠ±è´¹/ROAS/CPAï¼‰
2. WHEN é¡µé¢åŠ è½½ THEN User Portal SHALL æ˜¾ç¤ºè¿‘ 7 å¤©çš„ ROAS è¶‹åŠ¿å›¾
3. WHEN é¡µé¢åŠ è½½ THEN User Portal SHALL æ˜¾ç¤ºè¿‘ 7 å¤©çš„ CPA è¶‹åŠ¿å›¾
4. WHEN é¡µé¢åŠ è½½ THEN User Portal SHALL æ˜¾ç¤ºèŠ±è´¹ç»“æ„é¥¼å›¾ï¼ˆæŒ‰ Campaign åˆ†å¸ƒï¼‰
5. WHEN ç”¨æˆ·é€‰æ‹©æ—¶é—´èŒƒå›´ THEN User Portal SHALL æ›´æ–°æ‰€æœ‰å›¾è¡¨æ•°æ®

---

### éœ€æ±‚ 15.1ï¼šå¤šå±‚çº§æ•°æ®å±•ç¤º

**ç”¨æˆ·æ•…äº‹**ï¼šä½œä¸ºç”¨æˆ·ï¼Œæˆ‘æƒ³æŸ¥çœ‹ä¸åŒå±‚çº§çš„æ•°æ®ï¼Œä»¥ä¾¿å®šä½é—®é¢˜ã€‚

#### éªŒæ”¶æ ‡å‡†

1. WHEN ç”¨æˆ·è®¿é—®æŠ¥è¡¨é¡µé¢ THEN User Portal SHALL é»˜è®¤æ˜¾ç¤º Campaign å±‚çº§æ•°æ®
2. WHEN ç”¨æˆ·ç‚¹å‡» Campaign THEN User Portal SHALL å±•å¼€æ˜¾ç¤ºè¯¥ Campaign ä¸‹çš„ Adset æ•°æ®
3. WHEN ç”¨æˆ·ç‚¹å‡» Adset THEN User Portal SHALL å±•å¼€æ˜¾ç¤ºè¯¥ Adset ä¸‹çš„ Ad æ•°æ®
4. WHEN ç”¨æˆ·ç‚¹å‡» Ad THEN User Portal SHALL æ˜¾ç¤ºè¯¥ Ad çš„ç´ æè¡¨ç°
5. WHEN ç”¨æˆ·åˆ‡æ¢å±‚çº§ THEN User Portal SHALL ä¿æŒç­›é€‰å’Œæ’åºæ¡ä»¶

---

### éœ€æ±‚ 15.2ï¼šå›¾è¡¨äº¤äº’

**ç”¨æˆ·æ•…äº‹**ï¼šä½œä¸ºç”¨æˆ·ï¼Œæˆ‘æƒ³ä¸å›¾è¡¨äº¤äº’ï¼Œä»¥ä¾¿æ·±å…¥åˆ†ææ•°æ®ã€‚

#### éªŒæ”¶æ ‡å‡†

1. WHEN ç”¨æˆ·æ‚¬åœåœ¨æ•°æ®ç‚¹ THEN User Portal SHALL æ˜¾ç¤ºè¯¦ç»†æ•°å€¼
2. WHEN ç”¨æˆ·ç‚¹å‡»å›¾ä¾‹ THEN User Portal SHALL åˆ‡æ¢å¯¹åº”æ•°æ®ç³»åˆ—çš„æ˜¾ç¤º/éšè—
3. WHEN ç”¨æˆ·æ‹–åŠ¨æ—¶é—´è½´ THEN User Portal SHALL ç¼©æ”¾æ—¶é—´èŒƒå›´
4. WHEN ç”¨æˆ·ç‚¹å‡»æ•°æ®ç‚¹ THEN User Portal SHALL æ˜¾ç¤ºè¯¥æ—¶é—´ç‚¹çš„è¯¦ç»†æ•°æ®
5. WHEN ç”¨æˆ·å¯¼å‡ºå›¾è¡¨ THEN User Portal SHALL ç”Ÿæˆ PNG æˆ– SVG æ–‡ä»¶

---

## éåŠŸèƒ½æ€§éœ€æ±‚ï¼ˆNon-Functional Requirementsï¼‰

### æ€§èƒ½éœ€æ±‚

1. User Portal SHALL åœ¨ 5 ç§’å†…åŠ è½½ Dashboard é¡µé¢
2. User Portal SHALL åœ¨ 2 ç§’å†…å“åº”ç”¨æˆ·æ“ä½œ
3. User Portal SHALL æ”¯æŒ 10 ä¸ªå¹¶å‘ç”¨æˆ·ï¼ˆMVP é˜¶æ®µï¼‰

### å®‰å…¨éœ€æ±‚

1. User Portal SHALL ä½¿ç”¨ bcrypt åŠ å¯†å­˜å‚¨ç”¨æˆ·å¯†ç 
2. User Portal SHALL ä½¿ç”¨ AES-256 åŠ å¯†å­˜å‚¨ OAuth ä»¤ç‰Œ
3. User Portal SHALL å¼ºåˆ¶ä½¿ç”¨ HTTPS è¿æ¥

### åˆè§„æ€§éœ€æ±‚

1. User Portal SHALL ç¬¦åˆ GDPR æ•°æ®éšç§è¦æ±‚
2. User Portal SHALL æä¾›ç”¨æˆ·æ•°æ®å¯¼å‡ºåŠŸèƒ½
3. User Portal SHALL æä¾›ç”¨æˆ·æ•°æ®åˆ é™¤åŠŸèƒ½
4. User Portal SHALL æ˜¾ç¤º Cookie åŒæ„å¼¹çª—

---

## ç³»ç»Ÿè¾¹ç•Œï¼ˆSystem Boundariesï¼‰

### åŒ…å«çš„åŠŸèƒ½
- ç”¨æˆ·æ³¨å†Œã€ç™»å½•ã€è®¤è¯
- å¹¿å‘Šè´¦æˆ·ç»‘å®šï¼ˆMeta/TikTok/Googleï¼‰
- è®¢é˜…ç®¡ç†å’Œè®¡è´¹
- Dashboard ä»ªè¡¨æ¿
- **åµŒå…¥å¼ AI Agent å¯¹è¯ç•Œé¢**ï¼ˆç”¨æˆ·å…¥å£ï¼‰
- **WebSocket å®æ—¶é€šä¿¡**ï¼ˆä¸ AI Agent é€šä¿¡ï¼‰
- ç”¨æˆ·è®¾ç½®
- **ç´ æç®¡ç†æ¨¡å—**ï¼ˆå­˜å‚¨å’Œç®¡ç†æ‰€æœ‰ç´ æï¼‰
- **æŠ¥è¡¨æ•°æ®æ¨¡å—**ï¼ˆå­˜å‚¨å¹¿å‘Šå¹³å°æ•°æ®ï¼‰
- **è½åœ°é¡µç®¡ç†æ¨¡å—**ï¼ˆå­˜å‚¨å’Œç®¡ç†è½åœ°é¡µï¼‰
- **æŠ•æ”¾ç®¡ç†æ¨¡å—**ï¼ˆå­˜å‚¨ Campaign/Adset/Ad æ•°æ®ï¼‰
- **MCP Server**ï¼ˆä¸º AI Agent æä¾›æ•°æ®è®¿é—®ï¼‰
- æƒé™å’Œé™é¢æ§åˆ¶

### ä¸åŒ…å«çš„åŠŸèƒ½
- AI å¯¹è¯é€»è¾‘ï¼ˆç”±ç»Ÿä¸€ AI Agent è´Ÿè´£ï¼‰
- æ„å›¾è¯†åˆ«å’Œåè°ƒï¼ˆç”±ç»Ÿä¸€ AI Agent è´Ÿè´£ï¼‰
- ç´ æç”Ÿæˆç®—æ³•ï¼ˆç”± AI Agent çš„ Creative Capability è´Ÿè´£ï¼‰
- æ•°æ®åˆ†æç®—æ³•ï¼ˆç”± AI Agent çš„ Reporting Capability è´Ÿè´£ï¼‰
- å¹¿å‘Šç­–ç•¥ç”Ÿæˆï¼ˆç”± AI Agent çš„ Market Intelligence Capability è´Ÿè´£ï¼‰

---

## æŠ€æœ¯çº¦æŸï¼ˆTechnical Constraintsï¼‰

### å‰ç«¯æŠ€æœ¯æ ˆ

- **æ¡†æ¶**ï¼šNext.js 14 + TypeScript
- **æ ·å¼**ï¼šTailwind CSS + Shadcn/ui
- **AI å¯¹è¯ SDK**ï¼šVercel AI SDKï¼ˆ`ai` åŒ…ï¼‰
- **çŠ¶æ€ç®¡ç†**ï¼šZustand æˆ– React Context
- **å›¾è¡¨**ï¼šRecharts æˆ– Tremor

### Vercel AI SDK é€‰å‹ç†ç”±

| ç‰¹æ€§ | Vercel AI SDK | CopilotKit | è‡ªå®šä¹‰å®ç° |
|------|--------------|------------|-----------|
| Next.js é›†æˆ | âœ… æ·±åº¦é›†æˆ | âš ï¸ éœ€é…ç½® | âŒ éœ€è‡ªè¡Œå®ç° |
| æµå¼å“åº” | âœ… åŸç”Ÿæ”¯æŒ | âœ… æ”¯æŒ | âš ï¸ éœ€æ‰‹åŠ¨å¤„ç† |
| å·¥å…·è°ƒç”¨ UI | âœ… åŸç”Ÿæ”¯æŒ | âœ… æ”¯æŒ | âŒ éœ€è‡ªè¡Œå®ç° |
| TypeScript | âœ… å®Œæ•´ç±»å‹ | âœ… æ”¯æŒ | âš ï¸ éœ€è‡ªè¡Œå®šä¹‰ |
| React Hooks | âœ… useChat/useCompletion | âœ… useCopilotChat | âŒ éœ€è‡ªè¡Œå®ç° |
| ç¤¾åŒºç”Ÿæ€ | âœ… Vercel å®˜æ–¹ç»´æŠ¤ | âš ï¸ è¾ƒå° | - |
| åç«¯æ— å…³ | âœ… æ”¯æŒä»»æ„åç«¯ | âš ï¸ æœ‰é™ | âœ… å®Œå…¨è‡ªç”± |

### åç«¯æŠ€æœ¯æ ˆ

- **åç«¯æ¡†æ¶**ï¼šFastAPI (Python 3.11+)
- æ•°æ®åº“ï¼šPostgreSQL 14 (AWS RDS) + TimescaleDB æ‰©å±•ï¼ˆæ—¶åºæ•°æ®ï¼‰
- ç¼“å­˜ï¼šRedis (AWS ElastiCache)
- æ–‡ä»¶å­˜å‚¨ï¼šAWS S3
- CDNï¼šCloudFront
- è®¤è¯ï¼šAuth0 æˆ– Firebase Authentication
- æ”¯ä»˜ï¼šStripe
- AI Agent é€šä¿¡ï¼š
  - WebSocketï¼ˆå‰ç«¯ â†” AI Agentï¼‰
  - MCP Protocolï¼ˆAI Agent â†” User Portalï¼‰
- éƒ¨ç½²ï¼šAWS æ–°åŠ å¡ï¼ˆECS + RDS + ElastiCache + S3ï¼‰

## å¯¹è¯ç•Œé¢è®¾è®¡ï¼ˆChat UI Designï¼‰

### ç•Œé¢å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Dashboard                                    [ç”¨æˆ·å¤´åƒ] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  [æ ¸å¿ƒæŒ‡æ ‡å¡ç‰‡]  [è¶‹åŠ¿å›¾è¡¨]  [AI å»ºè®®]                  â”‚
â”‚                                                         â”‚
â”‚                                                         â”‚
â”‚                                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚                                          â”‚            â”‚ â”‚
â”‚                                          â”‚  AI Agent  â”‚ â”‚
â”‚                                          â”‚  å¯¹è¯çª—å£  â”‚ â”‚
â”‚                                          â”‚            â”‚ â”‚
â”‚                                          â”‚  ç”¨æˆ·: ... â”‚ â”‚
â”‚                                          â”‚  AI: ...   â”‚ â”‚
â”‚                                          â”‚            â”‚ â”‚
â”‚                                          â”‚  [è¾“å…¥æ¡†]  â”‚ â”‚
â”‚                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                         â”‚
â”‚                                          [ğŸ’¬ å¯¹è¯å›¾æ ‡]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å¯¹è¯çª—å£åŠŸèƒ½

1. **å±•å¼€/æ”¶èµ·**ï¼šç‚¹å‡»å³ä¸‹è§’å›¾æ ‡å±•å¼€æˆ–æ”¶èµ·
2. **æµå¼æ˜¾ç¤º**ï¼šAI å›å¤é€å­—æ˜¾ç¤ºï¼Œæå‡ä½“éªŒ
3. **å¯Œæ–‡æœ¬æ”¯æŒ**ï¼šæ”¯æŒ Markdownã€ä»£ç å—ã€å›¾è¡¨
4. **å¿«é€Ÿæ“ä½œ**ï¼šAI å»ºè®®æ˜¾ç¤ºä¸ºå¯ç‚¹å‡»æŒ‰é’®
5. **å†å²è®°å½•**ï¼šè‡ªåŠ¨ä¿å­˜å¯¹è¯å†å²
6. **å¤šåª’ä½“è¾“å…¥**ï¼šæ”¯æŒæ–‡æœ¬ã€å›¾ç‰‡ã€é“¾æ¥

---

## Vercel AI SDK å®ç°ç¤ºä¾‹

### 1. å®‰è£…ä¾èµ–

```bash
npm install ai @ai-sdk/react
```

### 2. å¯¹è¯ç»„ä»¶ï¼ˆuseChat Hookï¼‰

```tsx
// components/chat/ChatWindow.tsx
"use client";

import { useChat, Message } from "ai/react";
import { useState } from "react";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { ScrollArea } from "@/components/ui/scroll-area";
import { MessageBubble } from "./MessageBubble";
import { ToolCallCard } from "./ToolCallCard";

export function ChatWindow() {
  const [isOpen, setIsOpen] = useState(false);

  const {
    messages,
    input,
    handleInputChange,
    handleSubmit,
    isLoading,
    error,
    reload,
    stop,
  } = useChat({
    api: "/api/chat",  // Next.js API Route
    // æˆ–è€…ç›´æ¥è¿æ¥åç«¯
    // api: "https://agent.aae.com/api/chat",
    onResponse(response) {
      // å“åº”å¼€å§‹æ—¶çš„å›è°ƒ
      console.log("Streaming started");
    },
    onFinish(message) {
      // å“åº”å®Œæˆæ—¶çš„å›è°ƒ
      console.log("Message completed:", message);
    },
    onError(error) {
      // é”™è¯¯å¤„ç†
      console.error("Chat error:", error);
    },
  });

  return (
    <>
      {/* æ‚¬æµ®æŒ‰é’® */}
      <Button
        className="fixed bottom-4 right-4 rounded-full w-14 h-14 shadow-lg"
        onClick={() => setIsOpen(!isOpen)}
      >
        ğŸ’¬
      </Button>

      {/* å¯¹è¯çª—å£ */}
      {isOpen && (
        <div className="fixed bottom-20 right-4 w-96 h-[600px] bg-white rounded-lg shadow-xl flex flex-col">
          {/* å¤´éƒ¨ */}
          <div className="p-4 border-b flex justify-between items-center">
            <h3 className="font-semibold">AI æŠ•æ”¾åŠ©æ‰‹</h3>
            <Button variant="ghost" size="sm" onClick={() => setIsOpen(false)}>
              âœ•
            </Button>
          </div>

          {/* æ¶ˆæ¯åˆ—è¡¨ */}
          <ScrollArea className="flex-1 p-4">
            {messages.map((message) => (
              <div key={message.id}>
                <MessageBubble message={message} />

                {/* æ˜¾ç¤ºå·¥å…·è°ƒç”¨çŠ¶æ€ */}
                {message.toolInvocations?.map((toolInvocation) => (
                  <ToolCallCard
                    key={toolInvocation.toolCallId}
                    toolInvocation={toolInvocation}
                  />
                ))}
              </div>
            ))}

            {/* åŠ è½½çŠ¶æ€ */}
            {isLoading && (
              <div className="flex items-center gap-2 text-gray-500">
                <span className="animate-pulse">â—</span>
                AI æ­£åœ¨æ€è€ƒ...
              </div>
            )}
          </ScrollArea>

          {/* è¾“å…¥æ¡† */}
          <form onSubmit={handleSubmit} className="p-4 border-t flex gap-2">
            <Input
              value={input}
              onChange={handleInputChange}
              placeholder="è¾“å…¥æ¶ˆæ¯..."
              disabled={isLoading}
            />
            <Button type="submit" disabled={isLoading || !input.trim()}>
              å‘é€
            </Button>
            {isLoading && (
              <Button type="button" variant="outline" onClick={stop}>
                åœæ­¢
              </Button>
            )}
          </form>
        </div>
      )}
    </>
  );
}
```

### 3. æ¶ˆæ¯æ°”æ³¡ç»„ä»¶

```tsx
// components/chat/MessageBubble.tsx
import { Message } from "ai";
import ReactMarkdown from "react-markdown";
import { cn } from "@/lib/utils";

interface MessageBubbleProps {
  message: Message;
}

export function MessageBubble({ message }: MessageBubbleProps) {
  const isUser = message.role === "user";

  return (
    <div
      className={cn(
        "mb-4 flex",
        isUser ? "justify-end" : "justify-start"
      )}
    >
      <div
        className={cn(
          "max-w-[80%] rounded-lg px-4 py-2",
          isUser
            ? "bg-blue-500 text-white"
            : "bg-gray-100 text-gray-900"
        )}
      >
        {isUser ? (
          <p>{message.content}</p>
        ) : (
          <ReactMarkdown
            className="prose prose-sm max-w-none"
            components={{
              // è‡ªå®šä¹‰ä»£ç å—æ¸²æŸ“
              code({ node, inline, className, children, ...props }) {
                return inline ? (
                  <code className="bg-gray-200 px-1 rounded" {...props}>
                    {children}
                  </code>
                ) : (
                  <pre className="bg-gray-800 text-white p-2 rounded overflow-x-auto">
                    <code {...props}>{children}</code>
                  </pre>
                );
              },
            }}
          >
            {message.content}
          </ReactMarkdown>
        )}
      </div>
    </div>
  );
}
```

### 4. å·¥å…·è°ƒç”¨å¡ç‰‡

```tsx
// components/chat/ToolCallCard.tsx
import { ToolInvocation } from "ai";
import { Card } from "@/components/ui/card";
import { Loader2, CheckCircle, XCircle } from "lucide-react";

interface ToolCallCardProps {
  toolInvocation: ToolInvocation;
}

export function ToolCallCard({ toolInvocation }: ToolCallCardProps) {
  const { toolName, state, result } = toolInvocation;

  // å·¥å…·åç§°æ˜ å°„
  const toolDisplayNames: Record<string, string> = {
    create_creative: "ç”Ÿæˆç´ æ",
    create_campaign: "åˆ›å»ºå¹¿å‘Š",
    get_reports: "è·å–æŠ¥è¡¨",
    analyze_performance: "åˆ†æè¡¨ç°",
  };

  return (
    <Card className="p-3 mb-2 bg-blue-50 border-blue-200">
      <div className="flex items-center gap-2">
        {state === "call" && (
          <>
            <Loader2 className="w-4 h-4 animate-spin text-blue-500" />
            <span className="text-sm text-blue-700">
              æ­£åœ¨{toolDisplayNames[toolName] || toolName}...
            </span>
          </>
        )}

        {state === "result" && (
          <>
            <CheckCircle className="w-4 h-4 text-green-500" />
            <span className="text-sm text-green-700">
              {toolDisplayNames[toolName] || toolName}å®Œæˆ
            </span>
          </>
        )}
      </div>

      {/* æ˜¾ç¤ºç»“æœæ‘˜è¦ */}
      {state === "result" && result && (
        <div className="mt-2 text-xs text-gray-600">
          {typeof result === "object" && "message" in result && (
            <p>{result.message}</p>
          )}
        </div>
      )}
    </Card>
  );
}
```

### 5. Next.js API Routeï¼ˆä»£ç†åˆ°åç«¯ï¼‰

```ts
// app/api/chat/route.ts
import { StreamingTextResponse, LangChainStream } from "ai";

export const runtime = "edge";

export async function POST(req: Request) {
  const { messages } = await req.json();

  // è·å–ç”¨æˆ· session
  const session = await getSession(req);

  // è½¬å‘åˆ° LangGraph åç«¯
  const response = await fetch(`${process.env.AGENT_API_URL}/chat`, {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      Authorization: `Bearer ${session.accessToken}`,
    },
    body: JSON.stringify({
      messages,
      user_id: session.userId,
      session_id: session.chatSessionId,
    }),
  });

  // è¿”å›æµå¼å“åº”
  return new StreamingTextResponse(response.body!);
}
```

### 6. ä¸ LangGraph åç«¯é›†æˆ

```python
# FastAPI åç«¯ - è¿”å› Vercel AI SDK å…¼å®¹çš„æµå¼å“åº”
from fastapi import FastAPI
from fastapi.responses import StreamingResponse
from langchain_core.messages import HumanMessage
import json

app = FastAPI()

@app.post("/chat")
async def chat(request: ChatRequest):
    """å¤„ç†èŠå¤©è¯·æ±‚ï¼Œè¿”å› Vercel AI SDK å…¼å®¹çš„æµå¼å“åº”"""

    async def generate():
        config = {"configurable": {"thread_id": request.session_id}}

        initial_state = {
            "messages": [HumanMessage(content=request.messages[-1]["content"])],
            "user_id": request.user_id,
            "session_id": request.session_id,
        }

        async for event in agent.astream_events(initial_state, config, version="v2"):
            if event["event"] == "on_chat_model_stream":
                # æµå¼æ–‡æœ¬è¾“å‡º
                content = event["data"]["chunk"].content
                if content:
                    # Vercel AI SDK æ ¼å¼: "0:text\n"
                    yield f"0:{json.dumps(content)}\n"

            elif event["event"] == "on_tool_start":
                # å·¥å…·è°ƒç”¨å¼€å§‹
                tool_call = {
                    "toolCallId": event["run_id"],
                    "toolName": event["name"],
                    "args": event["data"]["input"],
                }
                yield f"9:{json.dumps(tool_call)}\n"

            elif event["event"] == "on_tool_end":
                # å·¥å…·è°ƒç”¨ç»“æŸ
                tool_result = {
                    "toolCallId": event["run_id"],
                    "result": event["data"]["output"],
                }
                yield f"a:{json.dumps(tool_result)}\n"

        # ç»“æŸæ ‡è®°
        yield "d:{}\n"

    return StreamingResponse(
        generate(),
        media_type="text/plain",
        headers={
            "X-Vercel-AI-Data-Stream": "v1",
        }
    )
```

---

### WebSocket æ¶ˆæ¯æ ¼å¼

```json
{
  "type": "user_message",
  "content": "å¸®æˆ‘ç”Ÿæˆç´ æå¹¶åˆ›å»ºå¹¿å‘Š",
  "user_id": "user123",
  "session_id": "session456",
  "timestamp": "2024-11-26T10:00:00Z"
}

{
  "type": "agent_message",
  "content": "å¥½çš„ï¼æ­£åœ¨ä¸ºä½ ç”Ÿæˆç´ æ...",
  "streaming": true,
  "session_id": "session456",
  "timestamp": "2024-11-26T10:00:01Z"
}

{
  "type": "agent_action",
  "action": "show_button",
  "button_text": "æŸ¥çœ‹ç´ æ",
  "button_action": "navigate_to_creatives",
  "session_id": "session456"
}
```

## æ¥å£åè®®ï¼ˆInterface Specificationsï¼‰

User Portal çš„æ‰€æœ‰æ¥å£åè®®è¯¦è§ï¼š**[INTERFACES.md](../INTERFACES.md)**

### å¯¹å¤–æ¥å£æ€»è§ˆ

1. **WebSocket API**ï¼šå‰ç«¯ â†” Unified AI Agent
2. **MCP Server**ï¼šUnified AI Agent â†” User Portal
3. **RESTful API**ï¼šå¯é€‰ï¼Œç”¨äºç¬¬ä¸‰æ–¹é›†æˆ

### MCP Server å·¥å…·åˆ—è¡¨

User Portal ä½œä¸º MCP Serverï¼Œæä¾›ä»¥ä¸‹å·¥å…·ç»™ Unified AI Agentï¼š

| å·¥å…·åç§° | æè¿° | ç”¨é€” |
|---------|------|------|
| `get_creatives` | è·å–ç´ æåˆ—è¡¨ | Creative Capability ä½¿ç”¨ |
| `create_creative` | åˆ›å»ºæ–°ç´ æ | Creative Capability ä½¿ç”¨ |
| `get_reports` | è·å–æŠ¥è¡¨æ•°æ® | Reporting Capability ä½¿ç”¨ |
| `analyze_performance` | åˆ†æå¹¿å‘Šè¡¨ç° | Reporting Capability ä½¿ç”¨ |
| `create_campaign` | åˆ›å»ºå¹¿å‘Š Campaign | Ad Engine Capability ä½¿ç”¨ |
| `update_budget` | æ›´æ–°å¹¿å‘Šé¢„ç®— | Ad Engine Capability ä½¿ç”¨ |
| `create_landing_page` | åˆ›å»ºè½åœ°é¡µ | Landing Page Capability ä½¿ç”¨ |
| `analyze_competitor` | åˆ†æç«å“ | Market Intelligence Capability ä½¿ç”¨ |

å®Œæ•´çš„å·¥å…·å®šä¹‰å’Œå‚æ•°è¯´æ˜è¯·å‚è€ƒï¼š**[INTERFACES.md - MCP åè®®](../INTERFACES.md#2-mcp-åè®®unified-ai-agent--user-portal)**

### WebSocket æ¶ˆæ¯æ ¼å¼

è¯¦è§ï¼š**[INTERFACES.md - WebSocket åè®®](../INTERFACES.md#1-websocket-åè®®å‰ç«¯--unified-ai-agent)**

### æ•°æ®æ¨¡å‹

è¯¦è§å„æ•°æ®ç®¡ç†æ¨¡å—çš„éœ€æ±‚è¯´æ˜ã€‚
