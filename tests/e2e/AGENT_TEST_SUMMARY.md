# AI Agent UI æµ‹è¯•æ€»ç»“

## æµ‹è¯•å¥—ä»¶æ¦‚è¿°

å·²åˆ›å»ºå®Œæ•´çš„ Playwright E2E æµ‹è¯•å¥—ä»¶ï¼Œç”¨äºæµ‹è¯• AAE å¹³å°çš„ AI Agent èƒ½åŠ›ã€‚æµ‹è¯•é€šè¿‡èŠå¤©ç•Œé¢ (http://localhost:3000/dashboard) ä¸ Agent äº¤äº’ã€‚

## åˆ›å»ºçš„æ–‡ä»¶

### æµ‹è¯•æ–‡ä»¶

1. **`agent-ui-capabilities.spec.ts`** (ä¸»è¦æµ‹è¯•æ–‡ä»¶)
   - 12 ä¸ªæµ‹è¯•ç»„
   - 50+ ä¸ªæµ‹è¯•ç”¨ä¾‹
   - è¦†ç›–æ‰€æœ‰ä¸»è¦ Agent èƒ½åŠ›

2. **`agent-core.spec.ts`** (å¿«é€Ÿæµ‹è¯•)
   - 5 ä¸ªæ ¸å¿ƒæµ‹è¯•ç”¨ä¾‹
   - ç”¨äºå¿«é€ŸéªŒè¯åŸºæœ¬åŠŸèƒ½

### è„šæœ¬æ–‡ä»¶

3. **`run-agent-tests.sh`** (å®Œæ•´æµ‹è¯•è¿è¡Œå™¨)
   - æ£€æŸ¥æœåŠ¡çŠ¶æ€
   - æ”¯æŒå¤šç§è¿è¡Œæ¨¡å¼
   - å½©è‰²è¾“å‡ºå’Œé”™è¯¯æç¤º

4. **`quick-test.sh`** (å¿«é€Ÿæµ‹è¯•è¿è¡Œå™¨)
   - å¿«é€ŸéªŒè¯æ ¸å¿ƒåŠŸèƒ½
   - è‡ªåŠ¨æ£€æŸ¥æœåŠ¡
   - æ˜¾ç¤ºæµè§ˆå™¨çª—å£

### æ–‡æ¡£æ–‡ä»¶

5. **`AGENT_UI_TEST_GUIDE.md`** (è¯¦ç»†æŒ‡å—)
   - å®Œæ•´çš„æµ‹è¯•æ–‡æ¡£
   - ä½¿ç”¨è¯´æ˜
   - æ•…éšœæ’é™¤
   - æœ€ä½³å®è·µ

## æµ‹è¯•è¦†ç›–èŒƒå›´

### 1. åŸºç¡€èŠå¤©äº¤äº’ (3 tests)
- âœ… æ‰“å¼€èŠå¤©æŠ½å±‰
- âœ… å‘é€å’Œæ¥æ”¶æ¶ˆæ¯
- âœ… å¤„ç†ç®€å•æŸ¥è¯¢

### 2. å¹¿å‘Šç³»åˆ—ç®¡ç† (4 tests)
- âœ… åˆ—å‡ºå¹¿å‘Šç³»åˆ—
- âœ… åˆ›å»ºå¹¿å‘Šç³»åˆ—ï¼ˆå¸¦ç¡®è®¤ï¼‰
- âœ… è·å–å¹¿å‘Šç³»åˆ—è¡¨ç°
- âœ… æš‚åœ/æ¢å¤å¹¿å‘Šç³»åˆ—

### 3. åˆ›æ„ç”Ÿæˆ (3 tests)
- âœ… ç”Ÿæˆå¹¿å‘Šåˆ›æ„
- âœ… åˆ—å‡ºç°æœ‰åˆ›æ„
- âœ… åˆ†æåˆ›æ„æ•ˆæœ

### 4. æ€§èƒ½åˆ†æ (4 tests)
- âœ… åˆ†æå¹¿å‘Šè¡¨ç°
- âœ… æ£€æµ‹æ•°æ®å¼‚å¸¸
- âœ… æä¾›ä¼˜åŒ–å»ºè®®
- âœ… ç”Ÿæˆæ€§èƒ½æŠ¥å‘Š

### 5. è½åœ°é¡µç®¡ç† (3 tests)
- âœ… åˆ—å‡ºè½åœ°é¡µ
- âœ… ç”Ÿæˆè½åœ°é¡µï¼ˆå¸¦ç¡®è®¤ï¼‰
- âœ… åˆ†æè½¬åŒ–ç‡

### 6. å¸‚åœºæ´å¯Ÿ (3 tests)
- âœ… åˆ†æå¸‚åœºè¶‹åŠ¿
- âœ… è¿½è¸ªç«äº‰å¯¹æ‰‹
- âœ… æä¾›å—ä¼—æ´å¯Ÿ

### 7. è´¦æˆ·ç®¡ç† (3 tests)
- âœ… æ˜¾ç¤ºè´¦æˆ·ä¿¡æ¯
- âœ… æ˜¾ç¤ºç§¯åˆ†ä½™é¢
- âœ… åˆ—å‡ºå¹¿å‘Šè´¦æˆ·

### 8. å¤šè½®å¯¹è¯ (2 tests)
- âœ… è·¨æ¶ˆæ¯ç»´æŠ¤ä¸Šä¸‹æ–‡
- âœ… å¤„ç†æ¾„æ¸…è¯·æ±‚

### 9. é”™è¯¯å¤„ç† (3 tests)
- âœ… å¤„ç†ä¸æ˜ç¡®çš„è¯·æ±‚
- âœ… å¤„ç†ç¼ºå¤±å‚æ•°
- âœ… å¤„ç†æ— æ•ˆæ“ä½œ

### 10. ç¡®è®¤æµç¨‹ (2 tests)
- âœ… ç ´åæ€§æ“ä½œçš„ç¡®è®¤
- âœ… æ¶ˆè€—ç§¯åˆ†æ“ä½œçš„ç¡®è®¤

### 11. å·¥å…·æ‰§è¡Œå¯è§æ€§ (2 tests)
- âœ… æ˜¾ç¤ºå·¥å…·æ‰§è¡ŒçŠ¶æ€
- âœ… å¤„ç†å·¥å…·æ‰§è¡Œé”™è¯¯

### 12. å“åº”è´¨é‡ (3 tests)
- âœ… æä¾›ç»“æ„åŒ–å“åº”
- âœ… æä¾›å¯æ“ä½œçš„å»ºè®®
- âœ… å¤„ç†åŒè¯­æŸ¥è¯¢ï¼ˆä¸­è‹±æ–‡ï¼‰

## å¿«é€Ÿå¼€å§‹

### 1. å¯åŠ¨æ‰€æœ‰æœåŠ¡

```bash
# Terminal 1: Backend
cd backend
uvicorn app.main:app --reload --port 8000

# Terminal 2: Frontend
cd frontend
npm run dev

# Terminal 3: AI Orchestrator
cd ai-orchestrator
uvicorn app.main:app --reload --port 8001
```

### 2. å®‰è£…æµ‹è¯•ä¾èµ–

```bash
cd tests/e2e
npm install
npx playwright install
```

### 3. è¿è¡Œæµ‹è¯•

```bash
# å¿«é€Ÿæµ‹è¯•ï¼ˆæ¨èé¦–æ¬¡è¿è¡Œï¼‰
./quick-test.sh

# å®Œæ•´æµ‹è¯•å¥—ä»¶
./run-agent-tests.sh

# è°ƒè¯•æ¨¡å¼
./run-agent-tests.sh --debug

# UI æ¨¡å¼ï¼ˆæ¨èå¼€å‘æ—¶ä½¿ç”¨ï¼‰
./run-agent-tests.sh --ui
```

## æµ‹è¯•æ¶æ„ç‰¹ç‚¹

### çµæ´»çš„é€‰æ‹©å™¨ç­–ç•¥
- ä¸ä¾èµ–ç‰¹å®šçš„ data-testid
- ä½¿ç”¨æ–‡æœ¬å†…å®¹å’Œè¯­ä¹‰é€‰æ‹©å™¨
- æ”¯æŒä¸­è‹±æ–‡ç•Œé¢

### è‡ªåŠ¨æˆªå›¾
- æ¯ä¸ªæµ‹è¯•æ­¥éª¤ç”Ÿæˆæˆªå›¾
- ä¿å­˜åœ¨ `.playwright-mcp/` ç›®å½•
- ä¾¿äºè°ƒè¯•å’Œé—®é¢˜è¿½è¸ª

### æ™ºèƒ½ç­‰å¾…
- è‡ªåŠ¨ç­‰å¾… Agent å“åº”
- å¯é…ç½®è¶…æ—¶æ—¶é—´
- å¤„ç†å¼‚æ­¥æ“ä½œ

### é”™è¯¯å¤„ç†
- è¯¦ç»†çš„é”™è¯¯æ¶ˆæ¯
- æœåŠ¡çŠ¶æ€æ£€æŸ¥
- å¤±è´¥æ—¶çš„è°ƒè¯•ä¿¡æ¯

## æµ‹è¯•æ‰§è¡Œæµç¨‹

```
1. æ£€æŸ¥æœåŠ¡çŠ¶æ€
   â”œâ”€ Frontend (3000)
   â”œâ”€ Backend (8000)
   â””â”€ AI Orchestrator (8001)

2. æ‰“å¼€æµè§ˆå™¨
   â””â”€ å¯¼èˆªåˆ° /dashboard

3. æ‰“å¼€èŠå¤©
   â”œâ”€ ç‚¹å‡» AI åŠ©æ‰‹æŒ‰é’®
   â””â”€ ç­‰å¾…èŠå¤©ç•Œé¢åŠ è½½

4. å‘é€æ¶ˆæ¯
   â”œâ”€ è¾“å…¥æµ‹è¯•æ¶ˆæ¯
   â”œâ”€ æŒ‰ Enter å‘é€
   â””â”€ ç­‰å¾… Agent å“åº”

5. éªŒè¯å“åº”
   â”œâ”€ æ£€æŸ¥æ¶ˆæ¯å†…å®¹
   â”œâ”€ éªŒè¯åµŒå…¥ç»„ä»¶
   â””â”€ æ£€æŸ¥ç¡®è®¤å¯¹è¯æ¡†

6. ç”Ÿæˆæˆªå›¾
   â””â”€ ä¿å­˜åˆ° .playwright-mcp/

7. ç”ŸæˆæŠ¥å‘Š
   â””â”€ HTML æµ‹è¯•æŠ¥å‘Š
```

## ä¸ Agent æ¶æ„çš„å¯¹åº”å…³ç³»

æµ‹è¯•è¦†ç›–ä»¥ä¸‹ Agent æ¨¡å—ï¼š

### AI Orchestrator æ¨¡å—
```
ai-orchestrator/app/modules/
â”œâ”€â”€ ad_creative/          â†’ åˆ›æ„ç”Ÿæˆæµ‹è¯•
â”œâ”€â”€ ad_performance/       â†’ æ€§èƒ½åˆ†ææµ‹è¯•
â”œâ”€â”€ campaign_automation/  â†’ å¹¿å‘Šç³»åˆ—ç®¡ç†æµ‹è¯•
â”œâ”€â”€ landing_page/         â†’ è½åœ°é¡µæµ‹è¯•
â””â”€â”€ market_insights/      â†’ å¸‚åœºæ´å¯Ÿæµ‹è¯•
```

### Backend MCP Tools
```
backend/app/mcp/tools/
â”œâ”€â”€ campaign.py          â†’ å¹¿å‘Šç³»åˆ—æ“ä½œ
â”œâ”€â”€ creative.py          â†’ åˆ›æ„æ“ä½œ
â”œâ”€â”€ landing_page.py      â†’ è½åœ°é¡µæ“ä½œ
â”œâ”€â”€ report.py            â†’ æŠ¥å‘Šç”Ÿæˆ
â”œâ”€â”€ credit.py            â†’ ç§¯åˆ†ç®¡ç†
â”œâ”€â”€ ad_account.py        â†’ è´¦æˆ·ç®¡ç†
â””â”€â”€ notification.py      â†’ é€šçŸ¥ç®¡ç†
```

### Frontend ç»„ä»¶
```
frontend/src/components/chat/
â”œâ”€â”€ ChatButton.tsx       â†’ èŠå¤©æŒ‰é’®
â”œâ”€â”€ ChatDrawer.tsx       â†’ èŠå¤©æŠ½å±‰
â”œâ”€â”€ ChatWindow.tsx       â†’ èŠå¤©çª—å£
â”œâ”€â”€ MessageBubble.tsx    â†’ æ¶ˆæ¯æ°”æ³¡
â”œâ”€â”€ EmbeddedChart.tsx    â†’ åµŒå…¥å›¾è¡¨
â”œâ”€â”€ EmbeddedCard.tsx     â†’ åµŒå…¥å¡ç‰‡
â””â”€â”€ ActionButton.tsx     â†’ æ“ä½œæŒ‰é’®
```

## æµ‹è¯•æŠ¥å‘Šç¤ºä¾‹

è¿è¡Œæµ‹è¯•åä¼šç”Ÿæˆè¯¦ç»†æŠ¥å‘Šï¼š

```
Running 50 tests using 3 workers

  âœ“ AI Agent - Basic Chat Interaction (3/3)
  âœ“ AI Agent - Campaign Management (4/4)
  âœ“ AI Agent - Creative Generation (3/3)
  âœ“ AI Agent - Performance Analytics (4/4)
  âœ“ AI Agent - Landing Pages (3/3)
  âœ“ AI Agent - Market Intelligence (3/3)
  âœ“ AI Agent - Account Management (3/3)
  âœ“ AI Agent - Multi-turn Conversations (2/2)
  âœ“ AI Agent - Error Handling (3/3)
  âœ“ AI Agent - Confirmation Flows (2/2)
  âœ“ AI Agent - Tool Execution Visibility (2/2)
  âœ“ AI Agent - Response Quality (3/3)

  50 passed (2m 30s)

ğŸ“¸ Screenshots: .playwright-mcp/
ğŸ“Š Report: npx playwright show-report
```

## è°ƒè¯•æŠ€å·§

### 1. æŸ¥çœ‹æˆªå›¾
```bash
ls -la .playwright-mcp/
open .playwright-mcp/test-greeting.png
```

### 2. ä½¿ç”¨ UI æ¨¡å¼
```bash
./run-agent-tests.sh --ui
```

### 3. è¿è¡Œå•ä¸ªæµ‹è¯•
```bash
npx playwright test --grep "should open chat drawer"
```

### 4. æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
```bash
DEBUG=pw:api npx playwright test
```

### 5. æš‚åœæµ‹è¯•
åœ¨æµ‹è¯•ä»£ç ä¸­æ·»åŠ ï¼š
```typescript
await page.pause();
```

## å¸¸è§é—®é¢˜è§£å†³

### é—®é¢˜ 1: æœåŠ¡æœªè¿è¡Œ
```
âŒ Frontend not running on port 3000
```
**è§£å†³**: å¯åŠ¨ Frontend æœåŠ¡

### é—®é¢˜ 2: Agent æ— å“åº”
```
Timeout waiting for agent response
```
**è§£å†³**: 
- æ£€æŸ¥ AI Orchestrator æ—¥å¿—
- éªŒè¯ GEMINI_API_KEY
- æ£€æŸ¥ WebSocket è¿æ¥

### é—®é¢˜ 3: å…ƒç´ æœªæ‰¾åˆ°
```
Error: Timeout waiting for selector
```
**è§£å†³**:
- æ£€æŸ¥èŠå¤©ç•Œé¢æ˜¯å¦æ­£ç¡®æ¸²æŸ“
- éªŒè¯é€‰æ‹©å™¨æ˜¯å¦æ­£ç¡®
- å¢åŠ ç­‰å¾…æ—¶é—´

## ä¸‹ä¸€æ­¥

### æ‰©å±•æµ‹è¯•è¦†ç›–
1. æ·»åŠ æ›´å¤šè¾¹ç•Œæƒ…å†µæµ‹è¯•
2. æµ‹è¯•å¹¶å‘åœºæ™¯
3. æµ‹è¯•é•¿æ—¶é—´ä¼šè¯
4. æµ‹è¯•ç½‘ç»œé”™è¯¯æ¢å¤

### æ€§èƒ½æµ‹è¯•
1. æµ‹è¯•å“åº”æ—¶é—´
2. æµ‹è¯•å¹¶å‘ç”¨æˆ·
3. æµ‹è¯•å¤§é‡æ¶ˆæ¯å¤„ç†

### é›†æˆæµ‹è¯•
1. ä¸çœŸå®å¹¿å‘Šå¹³å°é›†æˆ
2. æµ‹è¯•å®Œæ•´çš„ç”¨æˆ·æµç¨‹
3. æµ‹è¯•æ•°æ®æŒä¹…åŒ–

## æ€»ç»“

âœ… åˆ›å»ºäº†å®Œæ•´çš„ Agent UI æµ‹è¯•å¥—ä»¶
âœ… è¦†ç›–æ‰€æœ‰ä¸»è¦ Agent èƒ½åŠ›
âœ… æä¾›çµæ´»çš„è¿è¡Œé€‰é¡¹
âœ… åŒ…å«è¯¦ç»†çš„æ–‡æ¡£å’ŒæŒ‡å—
âœ… æ”¯æŒè°ƒè¯•å’Œæ•…éšœæ’é™¤
âœ… å¯é›†æˆåˆ° CI/CD æµç¨‹

æµ‹è¯•å¥—ä»¶å·²å‡†å¤‡å°±ç»ªï¼Œå¯ä»¥å¼€å§‹æµ‹è¯• AI Agent çš„èƒ½åŠ›ï¼
